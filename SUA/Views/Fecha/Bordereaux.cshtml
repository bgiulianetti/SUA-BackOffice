@model SUA.Models.Bordereaux
<style>
    table {
        border-spacing: 20px;
    }

    td {
    }


    plus {
        display: inline-block;
        height: 134px;
        padding: 0;
        margin: 0;
        vertical-align: top;
        width: 104px;
        background-image: url( 'http://thinkingstiff.com/images/matt.jpg' );
        background-size: 100px 100px;
        height: 300px;
        width: 104px;
    }

    .form-control-override {
        width: 100%;
        height: 34px;
        padding: 6px 12px;
        font-size: 14px;
        line-height: 1.42857143;
        color: #555;
        background-color: #fff;
        background-image: none;
        border: 1px solid #ccc;
        border-radius: 4px;
        -webkit-box-shadow: inset 0 1px 1px rgba(0,0,0,.075);
        box-shadow: inset 0 1px 1px rgba(0,0,0,.075);
        -webkit-transition: border-color ease-in-out .15s,-webkit-box-shadow ease-in-out .15s;
        -o-transition: border-color ease-in-out .15s,box-shadow ease-in-out .15s;
        transition: border-color ease-in-out .15s,box-shadow ease-in-out .15s;
        background-color: #e0e1e2;
    }

    .form-control-button {
        width: 33px;
        height: 34px;
        padding: 6px 12px;
        font-size: 14px;
        line-height: 1.42857143;
        color: #555;
        background-color: #fff;
        background-image: none;
        border: 1px solid #ccc;
        border-radius: 4px;
        -webkit-box-shadow: inset 0 1px 1px rgba(0,0,0,.075);
        box-shadow: inset 0 1px 1px rgba(0,0,0,.075);
        -webkit-transition: border-color ease-in-out .15s,-webkit-box-shadow ease-in-out .15s;
        -o-transition: border-color ease-in-out .15s,box-shadow ease-in-out .15s;
        transition: border-color ease-in-out .15s,box-shadow ease-in-out .15s;
    }
</style>


<div class="main-content">
    @using (Html.BeginForm("Bordereaux", "Fecha", FormMethod.Post, new { enctype = "multipart/form-data" }))
    {
    if (ViewBag.mensaje == "creado")
    {
    <label>El bordereaux ha sido cargado con éxito. Puede verlo cargado en el <a href="@Url.RouteUrl("Fechas")">Listado de Fechas</a></label>
    }
    else if (ViewBag.mensaje == "actualizado")
    {
    <label>El bordereaux ha sido actualizado con éxito. Puede ver los cambios en el <a href="@Url.RouteUrl("Fechas")">Listado de Fechas</a></label>
    }
    else if (ViewBag.mensaje == "Get")
    {
    <div class="panel">
        <div class="panel-body">
            <form data-id="" id="pdf-create-form" to-action="/pdfs/create">


                <table style="border-spacing: 20px">
                    <tr>
                        <td>
                            <label>Entradas </label>
                            <select class="form-control" id="entradasList" style="width:200px">
                                @foreach (var item in ViewBag.entradas)
                                {
                                <option value="@item.Text">@item.Value</option>
                                }
                            </select>
                        </td>
                        <td>
                            <label>Cantidad </label>
                            <input id="entradaCantidad" class="form-control" type="number" min="0" style="width:120px" />
                        </td>
                        <td>
                            <label>Precio </label>
                            <input id="entradaPrecio" class="form-control" type="number" step="0.01" min="0" style="width:120px" />
                        </td>
                        <td>
                            <label>Total </label>
                            <input id="entradaTotal" class="form-control" type="number" step="0.01" min="0" readonly style="width:120px" />
                        </td>
                        <td>
                            <label>&nbsp;</label>
                            <input id="addEntrada" class="form-control" value="+" type="button" />
                        </td>
                    </tr>
                </table>

                <div id="entradasDiv">
                    @if(ViewBag.accion == "Put")
                    {
                    int contador = 1;
                    <div id="EntradasAgregadas">
                        @foreach (var item in Model.Entradas)
                        {
                        var idEntrada = contador + "-a";
                        var idCantidad = contador + "-b";
                        var idPrecio = contador + "-c";
                        var idTotal = contador + "-d";

                        <input id="@idEntrada" class="form-control-override" value="@item.Nombre" type="text" readonly style="width:200px" />
                        <input id="@idCantidad" class="form-control-override" value="@item.Cantidad" type="text" readonly style="width:120px" />
                        <input id="@idPrecio" class="form-control-override" value="@item.Precio" type="text" readonly style="width:120px" />
                        <input id="@idTotal" class="form-control-override" value="@item.Total" type="text" readonly style="width:120px" />
                        <input id="deleteEntrada" class="form-control-button" value="-" type="button" /><br />

                        contador = contador + 1;
                        }
                    </div>
                    }
                </div>

                <table style="border-spacing: 20px">
                    <tr>
                        <td>
                            <br />
                            <label>Total</label>
                            @Html.TextBoxFor(model => model.EntradasTotal, new { @id="entradasTotal",  @class = "form-control", Style = "width:300px", required = "required", @type = "number", @step= "0.01", @readonly="readonly"})
                        </td>
                        <td>
                            <br />
                            <label>Bruto</label>
                            @Html.TextBoxFor(model => model.EntradasBruno, new { @id = "entradasBruto", @class = "form-control", Style = "width:300px", required = "required", @type = "number", @step = "0.01", @placeholder = "$", @readonly = "readonly" })
                        </td>
                    </tr>
                </table>

                <hr style="color: #8dd9f7">

                <table style="border-spacing: 20px">
                    <tr>
                        <td>
                            <label>Impuestos y Deducciones</label>
                            <select class="form-control" id="impuestosList" style="width:200px">
                                @foreach (var item in ViewBag.impuestos)
                                {
                                <option value="@item.Text">@item.Value</option>
                                }
                            </select>
                        </td>
                        <td>
                            <label>% </label>
                            <input id="impuestoPorcentaje" class="form-control" type="number" min="0" max="100" style="width:75px" />
                        </td>
                        <td>
                            <label>$ </label>
                            <input id="impuestoMonto" class="form-control" type="number" step="0.01" min="0" style="width:75px" readonly />
                        </td>
                        <td>
                            <label>Comentarios </label>
                            <input id="impuestoComentarios" class="form-control" type="text" placeholder="[texto]" style="width:220px" />
                        </td>
                        <td>
                            <label>&nbsp;</label>
                            <input id="addImpuesto" class="form-control" value="+" type="button" />
                        </td>
                    </tr>
                </table>

                <div id="impuestosDiv">
                    @if (ViewBag.accion == "Put")
                    {
                    int contador = 1;
                    <div id="ImpuestosAgregados">
                        @foreach (var item in Model.ImpuestosDeduccionesTeatro)
                        {
                        var idImpuesto = contador + "-e";
                        var idPorcentaje = contador + "-f";
                        var idMonto = contador + "-g";
                        var idComentarios = contador + "-h";

                        <input id="@idImpuesto" class="form-control-override" value="@item.Nombre" type="text" readonly style="width:200px" />
                        <input id="@idPorcentaje" class="form-control-override" value="@item.Porcentaje" type="text" readonly style="width:75px" />
                        <input id="@idMonto" class="form-control-override" value="@item.Monto" type="text" readonly style="width:75px" />
                        <input id="@idComentarios" class="form-control-override" value="@item.Comentarios" type="text" readonly style="width:220px" />
                        <input id="deleteImpuesto" class="form-control-button" value="-" type="button" /><br />

                        contador = contador + 1;
                        }
                    </div>
                    }
                </div>

                <table style="border-spacing: 20px">
                    <tr>
                        <td>
                            <br />
                            <label>Bruto </label>
                            @Html.TextBoxFor(model => model.ImpuestosDeduccionesBruto, new { @id= "impuestosDeduccionesBruto", @class = "form-control", Style = "width:200px", required = "required", @type = "number", @step = "0.01", @readonly = "readonly" })
                        </td>
                        <td>
                            <br />
                            <label>Total a Deducir </label>
                            @Html.TextBoxFor(model => model.ImpuestosDeduccionesTotalDeducir, new { @id = "impuestosDeduccionesTotalDeducir", @class = "form-control", Style = "width:200px", required = "required", @type = "number", @step = "0.01", @readonly = "readonly", @value = "0" })
                        </td>
                        <td>
                            <br />
                            <label>Neto </label>
                            @Html.TextBoxFor(model => model.ImpuestosDeduccionesNeto, new { @id = "impuestosDeduccionesNeto", @class = "form-control", Style = "width:200px", required = "required", @type = "number", @step = "0.01", @readonly = "readonly" })
                        </td>
                    </tr>
                    <tr>
                        <td>
                            <br />
                            <label>Compañia </label>
                            @Html.TextBoxFor(model => model.ImpuestosDeduccionesCompanyPorcentaje, new { @id= "impuestosDeduccionesCompanyPorcentaje", @class = "form-control", Style = "width:200px", required = "required", @type = "number", @min="0", @max="100", @placeholder = "%" })
                        </td>
                        <td>
                            <br />
                            <label>&nbsp;</label>
                            @Html.TextBoxFor(model => model.ImpuestosDeduccionesCompanyMonto, new { @id = "impuestosDeduccionesCompanyMonto", @class = "form-control", Style = "width:200px", required = "required", @type = "number", @step = "0.01", @min = "0", @max = "100", @placeholder = "$", @readonly = "readonly" })
                        </td>
                    </tr>
                    <tr>
                        <td>
                            <br />
                            <label>Teatro </label>
                            @Html.TextBoxFor(model => model.ImpuestosDeduccionesTeatroPorcentaje, new { @id = "impuestosDeduccionesTeatroPorcentaje", @class = "form-control", Style = "width:200px", required = "required", @type = "number", @placeholder = "%", @readonly = "readonly" })
                        </td>
                        <td>
                            <br />
                            <label>&nbsp;</label>
                            @Html.TextBoxFor(model => model.ImpuestosDeduccionesTeatroMonto, new { @id = "impuestosDeduccionesTeatroMonto", @class = "form-control", Style = "width:200px", required = "required", @type = "number", @step = "0.01", @placeholder = "$", @readonly = "readonly" })
                        </td>
                    </tr>
                </table>

                <hr style="color: #8dd9f7">

                <table style="border-spacing: 20px">
                    <tr>
                        <td>
                            <label>Gastos Compañia </label>
                            <select class="form-control" id="gastosList" style="width:200px">
                                @foreach (var item in ViewBag.gastos)
                                {
                                <option value="@item.Text">@item.Value</option>
                                }
                            </select>
                        </td>
                        <td>
                            <label>Monto </label>
                            <input id="gastoMonto" class="form-control" type="number" min="0" style="width:120px" />
                        </td>
                        <td>
                            <label>&nbsp;</label>
                            <input id="addGasto" class="form-control" value="+" type="button" />
                        </td>
                    </tr>
                </table>

                <div id="gastosDiv">
                    @if (ViewBag.accion == "Put")
                    {
                    int contador = 1;
                    <div id="GastosAgregados">
                        @foreach (var item in Model.GastosCompany)
                        {
                        var idGasto = contador + "-i";
                        var idMonto = contador + "-j";

                        <input id="@idGasto" class="form-control-override" value="@item.Key" type="text" readonly style="width:200px" />
                        <input id="@idMonto" class="form-control-override" value="@item.Value" type="text" readonly style="width:120px" />
                        <input id="deleteGasto" class="form-control-button" value="-" type="button" /><br />

                        contador = contador + 1;
                        }
                    </div>
                    }
                </div>

                <table style="border-spacing: 20px">
                    <tr>
                        <td>
                            <br />
                            <label>Total Gastos </label>
                            @Html.TextBoxFor(model => model.GastosCompanyTotal, new { @class = "form-control", Style = "width:200px", required = "required", @type = "number", @step = "0.01", @readonly = "readonly" })
                        </td>
                        <td>
                            <br />
                            <label>Neto</label>
                            @Html.TextBoxFor(model => model.GastosCompanyNeto, new { @class = "form-control", Style = "width:200px", required = "required", @type = "number", @step = "0.01", @readonly = "readonly" })
                        </td>
                    </tr>
                </table>

                <hr style="color: #8dd9f7">

                <table style="border-spacing: 20px">
                    <tr>
                        <td>
                            <br />
                            <label>SUA </label>
                            @Html.TextBoxFor(model => model.SUAPorcentaje, new { @class = "form-control", Style = "width:200px", required = "required", @type = "number", @step = "0.01", @placeholder = "%" })
                        </td>
                        <td>
                            <br />
                            <label>&nbsp;</label>
                            @Html.TextBoxFor(model => model.SUAMonto, new { @class = "form-control", Style = "width:200px", required = "required", @type = "number", @step = "0.01", @placeholder = "$", @readonly = "readonly" })
                        </td>
                    </tr>
                    <tr>
                        <td>
                            <br />
                            <label>Show </label>
                            @Html.TextBoxFor(model => model.ShowPorcentaje, new { @class = "form-control", Style = "width:200px", required = "required", @type = "number", @step = "0.01", @placeholder = "%" })
                        </td>
                        <td>
                            <br />
                            <label>&nbsp;</label>
                            @Html.TextBoxFor(model => model.ShowMonto, new { @class = "form-control", Style = "width:200px", required = "required", @type = "number", @step = "0.01", @placeholder = "$", @readonly = "readonly" })
                        </td>
                    </tr>
                </table>

                <hr style="color: #8dd9f7">

                <table style="border-spacing: 20px">
                    <tr>
                        <td>
                            <label>Fecha de Cobro </label>
                            @if (ViewBag.accion == "Put")
                            {
                            @Html.TextBoxFor(model => model.FechaCobro, new { @class = "form-control", Style = "width:200px", required = "required", @type = "date", @Value = Model.FechaCobro.ToString("yyyy-MM-dd") })
                            }
                            else
                            {
                            @Html.TextBoxFor(model => model.FechaCobro, new { @class = "form-control", Style = "width:200px", required = "required", @type = "date" })
                            }


                        </td>
                    </tr>
                    <tr>
                        <td>
                            <br />
                            <label>Forma</label>
                            @Html.TextBoxFor(model => model.Forma, new { @class = "form-control", Style = "width:400px", required = "required" })
                        </td>
                    </tr>
                    <tr>
                        <td>
                            <br />
                            <label>Comentarios </label>
                            @Html.TextBoxFor(model => model.Comentarios, new { @class = "form-control", Style = "width:400px" })
                        </td>
                    </tr>
                </table>

                <hr style="color: #8dd9f7">

                <input name="accion" class="hidden" value="@ViewBag.accion" data-form="error-box" />


                <input name="_entradas" id="entradasSeleccionadas" class="hidden" data-form="error-box" />
                <input name="_impuestos" id="impuestosSeleccionados" class="hidden" data-form="error-box" />
                <input name="_gastos" id="gastosSeleccionados" class="hidden" data-form="error-box" />

                <input name="id" id="idFecha" class="hidden" data-form="error-box" />


                @if (ViewBag.accion == "Put")
                {
                <input id="counterEntradas" class="hidden" value="@Model.Entradas.Count" data-form="error-box" />
                <input id="counterImpuestos" class="hidden" value="@Model.ImpuestosDeduccionesTeatro.Count" data-form="error-box" />
                <input id="counterGastos" class="hidden" value="@Model.GastosCompany.Count" data-form="error-box" />
                <button id="btn_guardar" type="submit" class="btn btn-primary btn-block btn-submit-to-right">Guardar cambios</button>
                }
                else
                {
                <input id="counterEntradas" class="hidden" value="0" data-form="error-box" />
                <input id="counterImpuestos" class="hidden" value="0" data-form="error-box" />
                <input id="counterGastos" class="hidden" value="0" data-form="error-box" />
                <button id="btn_guardar" type="submit" class="btn btn-primary btn-block btn-submit-to-right">Guardar</button>
                }

            </form>
        </div>
    </div>
    }
    else
    {
    <label>@ViewBag.mensaje</label>
    }
    }

</div>

<script>

    if('@ViewBag.accion' == "Put")
    {
        //tomo el idFecha enviado por el action Method
        var _idFecha = '@ViewBag.idFecha';
        $("#idFecha").val(_idFecha);


        //agrego evento de click a boton 'eliminar entrada' agregado de forma dinamica en el Put
        $("#deleteEntrada").click(function () {
            $(this).parent().remove();

            RecorreEntradas();

            //Obtengo el contador y lo decremento
            var contador = parseInt($("#counterEntradas").val());
            contador = contador - 1;
            $("#counterEntradas").val(contador);
        });


        //agrego evento de click a boton 'eliminar impuesto' agregado de forma dinamica en el Put
        $("#deleteImpuesto").click(function () {
            $(this).parent().remove();

            RecorreImpuestos();

            //Obtengo el contador y lo decremento
            var contador = parseInt($("#counterImpuestos").val());
            contador = contador - 1;
            $("#counterImpuestos").val(contador);
        });

        //agrego evento de click a boton 'eliminar gasto' agregado de forma dinamica en el Put
        $("#deleteGasto").click(function () {
            $(this).parent().remove();

            RecorreGastos();

            //Obtengo el contador y lo decremento
            var contador = parseInt($("#counterGastos").val());
            contador = contador - 1;
            $("#counterGastos").val(contador);
        });


        RecorreEntradas();
        RecorreImpuestos();
        RecorreGastos();
    }
    else
    {
        //tomo el id de la querystring
        var _idFecha = window.location.href.split('=')[1];
        $("#idFecha").val(_idFecha);
    }


    $("#addEntrada").click(function ()
    {
        if ($("#entradaCantidad").val()  != "" && $("#entradaPrecio").val() != "")
        {
            //hago calculo
            var total = $("#entradaCantidad").val() * $("#entradaPrecio").val();
            $("#entradaTotal").val(total);

            //Obtengo el contador y lo incremento
            var contador = parseInt($("#counterEntradas").val());
            contador = contador + 1;
            $("#counterEntradas").val(contador);

            var divContenedor = jQuery('<div id="EntradasAgregadas"></div>');
            var entrada = jQuery('<input id="' + contador + '-a" class="form-control-override"  value="' + $("#entradasList option:selected").text() + '" type="text" readonly style="width:200px" />');
            var cantidad = jQuery('<input id="' + contador + '-b" class="form-control-override"  value="' + $("#entradaCantidad").val() + '" type="text" readonly style="width:120px" />');
            var precio = jQuery('<input id="' + contador + '-c" class="form-control-override"  value="' + $("#entradaPrecio").val() + '" type="text" readonly style="width:120px" />');
            var total = jQuery('<input id="' + contador + '-d" class="form-control-override"  value="' + $("#entradaTotal").val() + '" type="text" readonly style="width:120px" />');
            var eliminar = jQuery('<input class="form-control-button" value="-" type="button" /><br />');
            eliminar.click(function () {
                $(this).parent().remove();

                RecorreEntradas();

                //Obtengo el contador y lo decremento
                var contador = parseInt($("#counterEntradas").val());
                contador = contador - 1;
                $("#counterEntradas").val(contador);

            });

            divContenedor.append(entrada);
            divContenedor.append(cantidad);
            divContenedor.append(precio);
            divContenedor.append(total);
            divContenedor.append(eliminar);
            $('#entradasDiv').append(divContenedor);


            //borro los campos
            $("#entradaCantidad").val("");
            $("#entradaPrecio").val("");
            $("#entradaTotal").val("");

            RecorreEntradas();
        }
        else
        {
            alert("Debe completar precio y cantidad poder ingresar una entrada");
        }

    });

    $("#addImpuesto").click(function ()
    {

        if ($("#impuestoPorcentaje").val() != "")
        {
            //hago calculo
            var monto = $("#impuestoPorcentaje").val() * $("#entradasBruto").val() / 100;
            $("#impuestoMonto").val(monto);

            //Obtengo el contador y lo incremento
            var contador = parseInt($("#counterImpuestos").val());
            contador = contador + 1;
            $("#counterImpuestos").val(contador);

            var divContenedor = jQuery('<div id="ImpuestosAgregados"></div>');
            var impuesto = jQuery('<input id="' + contador + '-e" class="form-control-override"  value="' + $("#impuestosList option:selected").text() + '" type="text" readonly style="width:200px" />');
            var porcentaje = jQuery('<input id="' + contador + '-f" class="form-control-override"  value="' + $("#impuestoPorcentaje").val() + '" type="text" readonly style="width:75px" />');
            var monto = jQuery('<input id="' + contador + '-g" class="form-control-override"  value="' + $("#impuestoMonto").val() + '" type="text" readonly style="width:75px" />');
            var comentarios = jQuery('<input id="' + contador + '-h" class="form-control-override"  value="' + $("#impuestoComentarios").val() + '" type="text" readonly style="width:220px" />');
            var eliminar = jQuery('<input class="form-control-button" value="-" type="button" /><br />');
            eliminar.click(function () {
                $(this).parent().remove();

                RecorreImpuestos();

                //Obtengo el contador y lo decremento
                var contador = parseInt($("#counterImpuestos").val());
                contador = contador - 1;
                $("#counterImpuestos").val(contador);
            });

            divContenedor.append(impuesto);
            divContenedor.append(porcentaje);
            divContenedor.append(monto);
            divContenedor.append(comentarios);
            divContenedor.append(eliminar);
            $('#impuestosDiv').append(divContenedor);


            //borro los campos
            $("#impuestoPorcentaje").val("");
            $("#impuestoMonto").val("");
            $("#impuestoComentarios").val("");

            RecorreImpuestos();
        }
        else
        {
            alert("Debe ingresar un porcentaje válido");
        }
    });

    $("#addGasto").click(function () {

        //Obtengo el contador y lo incremento
        var contador = parseInt($("#counterGastos").val());
        contador = contador + 1;
        $("#counterGastos").val(contador);

        var divContenedor = jQuery('<div id="GastosAgregados"></div>');
        var gasto = jQuery('<input id="' + contador + '-i" class="form-control-override"  value="' + $("#gastosList option:selected").text() + '" type="text" readonly style="width:200px" />');
        var monto = jQuery('<input id="' + contador + '-j" class="form-control-override"  value="' + $("#gastoMonto").val() + '" type="text" readonly style="width:120px" />');
        var eliminar = jQuery('<input class="form-control-button" value="-" type="button" /><br />');
        eliminar.click(function () {
            $(this).parent().remove();

            RecorreGastos();

            //Obtengo el contador y lo decremento
            var contador = parseInt($("#counterGastos").val());
            contador = contador - 1;
            $("#counterGastos").val(contador);
        });

        divContenedor.append(gasto);
        divContenedor.append(monto);
        divContenedor.append(eliminar);
        $('#gastosDiv').append(divContenedor);


        //borro los campos
        $("#gastoMonto").val("");

        RecorreGastos();
    });

    function RecorreEntradas()
    {
        var cantidadEntradas = 0;
        var bruto = 0;
        var contador = parseInt($("#counterEntradas").val());
        var entradasString = "";
        for (var i = contador; i > 0; i--)
        {
            var idEntrada = "#" + i + "-a";
            var idCantidad = "#" + i + "-b";
            var idPrecio = "#" + i + "-c";
            var idTotal = "#" + i + "-d";

            if ($(idEntrada).val() != undefined)
            {
                if (entradasString == "")
                {
                    entradasString = $(idEntrada).val() + "-" + $(idCantidad).val() + "-" + $(idPrecio).val() + "-" + $(idTotal).val();
                }
                else
                {
                    entradasString = entradasString + "*" + $(idEntrada).val() + "-" + $(idCantidad).val() + "-" + $(idPrecio).val() + "-" + $(idTotal).val();
                }

                //Hago las sumatorias
                cantidadEntradas = cantidadEntradas + parseInt($(idCantidad).val());
                bruto = bruto + parseInt($(idTotal).val());
            }
        }

        //asigno los totales
        $("#entradasTotal").val(cantidadEntradas);
        $("#entradasBruto").val(bruto);

        CalcularTotalADeducirAndNeto(bruto);

        $("#entradasSeleccionadas").val(entradasString);

    }

    function RecorreImpuestos()
    {
        var totalDeducir = 0;
        var contador = parseInt($("#counterImpuestos").val());
        var entradasString = "";
        for (var i = contador; i > 0; i--)
        {
            var idImpuesto = "#" + i + "-e";
            var idPorcentaje = "#" + i + "-f";
            var idMonto = "#" + i + "-g";
            var idComentarios = "#" + i + "-h";

            if ($(idImpuesto).val() != undefined)
            {
                if (entradasString == "")
                {
                    entradasString = $(idImpuesto).val() + "-" + $(idPorcentaje).val() + "-" + $(idMonto).val() + "-" + $(idComentarios).val();
                }
                else
                {
                    entradasString = entradasString + "*" + $(idImpuesto).val() + "-" + $(idPorcentaje).val() + "-" + $(idMonto).val() + "-" + $(idComentarios).val();
                }

                //Hago las sumatorias
                totalDeducir = totalDeducir + parseInt($(idMonto).val());
            }
        }

        $("#impuestosDeduccionesTotalDeducir").val(totalDeducir);
        $("#impuestosDeduccionesNeto").val(parseInt($("#entradasBruto").val()) - totalDeducir);

        $("#impuestosSeleccionados").val(entradasString);
    }

    function RecorreGastos() {
        var contador = parseInt($("#counterGastos").val());
        var entradasString = "";
        for (var i = contador; i > 0; i--) {
            var idGasto = "#" + i + "-i";
            var idMonto = "#" + i + "-j";

            if ($(idGasto).val() != undefined) {
                if (entradasString == "") {
                    entradasString = $(idGasto).val() + "-" + $(idMonto).val();
                }
                else {
                    entradasString = entradasString + "*" + $(idGasto).val() + "-" + $(idMonto).val();
                }
            }
        }
        $("#gastosSeleccionados").val(entradasString);
    }

    function CalcularTotalADeducirAndNeto(bruto)
    {
        $("#impuestosDeduccionesBruto").val(bruto);
        $("#impuestosDeduccionesNeto").val(bruto - parseInt($("#impuestosDeduccionesTotalDeducir").val()));
    }



    $("#impuestosDeduccionesCompanyPorcentaje").bind('input', function () {
        var company = parseInt($('#impuestosDeduccionesCompanyPorcentaje').val());
        $('#impuestosDeduccionesTeatroPorcentaje').val(100 - company);

        var neto = parseInt($("#impuestosDeduccionesNeto").val());
        var montoCompany = neto * company / 100;
        var teatro = neto - montoCompany;
        $("#impuestosDeduccionesCompanyMonto").val(montoCompany);
        $("#impuestosDeduccionesTeatroMonto").val(teatro);
    });


</script>